<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>User - Party Hall Booking</title>
<link rel="stylesheet" href="style.css">
<style>
    .container {
        width: 90%;
        max-width: 800px;
        margin: 20px auto;
        background: white;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 0 10px rgba(0,0,0,0.2);
    }
    .hall {
        background: #f9f9f9;
        border-radius: 8px;
        padding: 15px;
        margin-bottom: 15px;
        box-shadow: 0 0 5px rgba(0,0,0,0.1);
    }
    .hall h3 {
        margin-top: 0;
    }
    .booking-form {
        display: none;
        background: #f4f4f4;
        padding: 15px;
        margin-top: 10px;
        border-radius: 8px;
    }
    .booking-form input, .booking-form textarea {
        width: 90%;
        padding: 8px;
        margin: 5px 0;
    }
    .logout-btn {
        float: right;
        background: crimson;
    }
</style>
</head>
<body>
    <h1>Welcome, User</h1>
    <button class="logout-btn" onclick="logout()">Logout</button>

    <div class="container">
        <h2>Search Party Halls</h2>
        <input type="text" id="city" placeholder="Enter City">
        <input type="text" id="locality" placeholder="Enter Locality">
        <button onclick="searchHalls()">Search</button>

        <div id="hallsList"></div>
    </div>

    <script>
        function logout(){
            window.location.href = "login.html";
        }

        // Search and display halls
        function searchHalls(){
            const city = document.getElementById('city').value.toLowerCase();
            const locality = document.getElementById('locality').value.toLowerCase();
            const halls = JSON.parse(localStorage.getItem('halls')) || [];
            const results = halls.filter(h => 
                h.city.toLowerCase().includes(city) && 
                h.locality.toLowerCase().includes(locality)
            );

            const listDiv = document.getElementById('hallsList');
            listDiv.innerHTML = "";

            if(results.length === 0){
                listDiv.innerHTML = "<p>No halls found.</p>";
                return;
            }

            results.forEach((h, index) => {
                const div = document.createElement('div');
                div.classList.add('hall');
                div.innerHTML = `
                    <h3>${h.name}</h3>
                    <p><b>City:</b> ${h.city}</p>
                    <p><b>Locality:</b> ${h.locality}</p>
                    <button onclick="showBookingForm(${index})">Book This Hall</button>

                    <div class="booking-form" id="form-${index}">
                        <h4>Booking Details</h4>
                        <input type="text" id="date-${index}" placeholder="Date of Function">
                        <input type="text" id="purpose-${index}" placeholder="Purpose">
                        <input type="number" id="people-${index}" placeholder="Number of People">
                        <input type="number" id="hours-${index}" placeholder="Hours Required">
                        <input type="text" id="contact-${index}" placeholder="Contact Details">
                        <textarea id="address-${index}" placeholder="Address"></textarea>
                        <button onclick="bookHall(${index})">Confirm Booking</button>
                    </div>
                `;
                listDiv.appendChild(div);
            });
        }

        // Show booking form
        function showBookingForm(index){
            const form = document.getElementById(`form-${index}`);
            form.style.display = form.style.display === "block" ? "none" : "block";
        }

        // Save booking
        function bookHall(index){
            const halls = JSON.parse(localStorage.getItem('halls')) || [];
            const hall = halls[index];

            const date = document.getElementById(`date-${index}`).value;
            const purpose = document.getElementById(`purpose-${index}`).value;
            const people = document.getElementById(`people-${index}`).value;
            const hours = document.getElementById(`hours-${index}`).value;
            const contact = document.getElementById(`contact-${index}`).value;
            const address = document.getElementById(`address-${index}`).value;

            if(!date || !purpose || !people || !hours || !contact || !address){
                alert("Please fill all details!");
                return;
            }

            const booking = {
                name: hall.name,
                city: hall.city,
                locality: hall.locality,
                date, purpose, people, hours, contact, address
            };

            const bookings = JSON.parse(localStorage.getItem('bookings')) || [];
            bookings.push(booking);
            localStorage.setItem('bookings', JSON.stringify(bookings));

            alert("ðŸŽ‰ Hall booked successfully!");
            document.getElementById(`form-${index}`).reset;
            document.getElementById(`form-${index}`).style.display = "none";
        }
    </script>
</body>
</html>
